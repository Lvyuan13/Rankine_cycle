%{
Reheat Rankine cycle
%}
EtaP=0.88;
EtaT=0.92;
KT=273.15;
T1=480+KT;
P1=8e3;
[h1,s1]=refpropm('HS','T',T1,'P',P1,'WATER');
P2s=0.7e3;
P2=P2s;
s2s=s1;
[h2s,T2s]=refpropm('HT','P',P2s,'S',s2s,'water');
h2=h1-EtaT*(h1-h2s);
P3=P2;
T3=440+KT;
[s3,h3]=refpropm('SH','T',T3,'P',P3,'water');
s4s=s3;
P4s=8;
[h4s,T4s]=refpropm('HT','P',P4s,'S',s4s,'water');
h4=h3-EtaT*(h3-h4s);
P4=P4s;
P5=P4;
[h5,s5]=refpropm('HS','P',P5,'Q',0,'water');
s6s=s5;
P6s=P1;
[h6s,s6s]=refpropm('HS','P',P6s,'S',s6s,'water');
h6=h5+(h6s-h5)/EtaP;
wt=h1-h2+h3-h4;
wp=h6-h5;
w=wt-wp;
q_boiler=h1-h6;
eta_Reheat=w/q_boiler
[~,~,eta]=Rankine_sub_P(T1,P4)